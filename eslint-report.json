[{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/api-gateway.controller.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/api-gateway.controller.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/api-gateway.module.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/api-gateway.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/auth.controller.ts","messages":[{"ruleId":"@typescript-eslint/require-await","severity":2,"message":"Async method 'getProfile' has no 'await' expression.","line":21,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":21,"endColumn":19,"suggestions":[{"messageId":"removeAsync","fix":{"range":[712,718],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":24,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":24,"endColumn":11}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Controller, Post, Body, Get, UseGuards } from '@nestjs/common';\r\nimport { AuthService } from './auth.service';\r\nimport { JwtAuthGuard } from './guards/jwt-auth.guard';\r\nimport { RolesGuard } from './guards/roles.guard';\r\nimport { CurrentUser } from './decorators/current-user.decorator';\r\nimport { Roles } from './decorators/roles.decorator';\r\nimport { Role } from './enums/role.enum';\r\n\r\n@Controller('auth')\r\nexport class AuthController {\r\n  constructor(private readonly authService: AuthService) {}\r\n\r\n  @Post('login')\r\n  async login(@Body('idToken') idToken: string) {\r\n    return this.authService.login(idToken);\r\n  }\r\n\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles(Role.ADMIN)\r\n  @Get('me')\r\n  async getProfile(@CurrentUser() user: any) {\r\n    return {\r\n      message: 'Success: You have ADMIN role.',\r\n      user,\r\n    };\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/auth.module.ts","messages":[{"ruleId":"@typescript-eslint/require-await","severity":2,"message":"Async method 'useFactory' has no 'await' expression.","line":20,"column":7,"nodeType":"ArrowFunctionExpression","messageId":"missingAwait","endLine":20,"endColumn":25,"suggestions":[{"messageId":"removeAsync","fix":{"range":[817,823],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":23,"column":11,"nodeType":"Property","messageId":"anyAssignment","endLine":23,"endColumn":72}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { User, UserSchema } from './schemas/user.schema';\r\nimport { AuthController } from './auth.controller';\r\nimport { AuthService } from './auth.service';\r\nimport { JwtStrategy } from './strategies/jwt.strategy';\r\nimport { JwtModule } from '@nestjs/jwt';\r\nimport { PassportModule } from '@nestjs/passport';\r\nimport { ConfigModule, ConfigService } from '@nestjs/config';\r\nimport { FirebaseModule } from '@logitrack/firebase';\r\n\r\n@Module({\r\n  imports: [\r\n    FirebaseModule,\r\n    MongooseModule.forFeature([{ name: User.name, schema: UserSchema }]),\r\n    PassportModule.register({ defaultStrategy: 'jwt' }),\r\n    JwtModule.registerAsync({\r\n      imports: [ConfigModule],\r\n      inject: [ConfigService],\r\n      useFactory: async (configService: ConfigService) => ({\r\n        secret: configService.get<string>('JWT_SECRET'),\r\n        signOptions: {\r\n          expiresIn: configService.get<string>('JWT_EXPIRES_IN') as any, // Cast to any to bypass string vs StringValue issue\r\n        },\r\n      }),\r\n    }),\r\n  ],\r\n  controllers: [AuthController],\r\n  providers: [AuthService, JwtStrategy],\r\n  exports: [AuthService, JwtModule, MongooseModule],\r\n})\r\nexport class AuthModule {}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/auth.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":20,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Injectable, Inject, UnauthorizedException } from '@nestjs/common';\r\nimport { JwtService } from '@nestjs/jwt';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport * as admin from 'firebase-admin';\r\nimport { User, UserDocument } from './schemas/user.schema';\r\n\r\n@Injectable()\r\nexport class AuthService {\r\n  constructor(\r\n    @Inject('FIREBASE_AUTH') private readonly firebaseAuth: admin.auth.Auth,\r\n    @InjectModel(User.name) private userModel: Model<UserDocument>,\r\n    private readonly jwtService: JwtService,\r\n  ) {}\r\n\r\n  async verifyFirebaseToken(idToken: string) {\r\n    try {\r\n      const decodedToken = await this.firebaseAuth.verifyIdToken(idToken);\r\n      return decodedToken;\r\n    } catch (error) {\r\n      throw new UnauthorizedException('Invalid Firebase Token');\r\n    }\r\n  }\r\n\r\n  async login(idToken: string) {\r\n    const decodedToken = await this.verifyFirebaseToken(idToken);\r\n    const { uid, email, phone_number, name, picture } = decodedToken;\r\n\r\n    const user = await this.userModel.findOneAndUpdate(\r\n      { firebaseUid: uid },\r\n      {\r\n        $setOnInsert: {\r\n          firebaseUid: uid,\r\n          email: email,\r\n          phoneNumber: phone_number,\r\n          fullName: name,\r\n          avatarUrl: picture,\r\n        },\r\n      },\r\n      { new: true, upsert: true },\r\n    );\r\n\r\n    if (!user.isActive) {\r\n      throw new UnauthorizedException('User account is deactivated');\r\n    }\r\n\r\n    const payload = { sub: user._id, roles: user.roles };\r\n    const accessToken = await this.jwtService.signAsync(payload);\r\n\r\n    return {\r\n      accessToken,\r\n      user,\r\n    };\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/decorators/current-user.decorator.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":5,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":5,"endColumn":52},{"ruleId":"@typescript-eslint/no-unsafe-return","severity":2,"message":"Unsafe return of a value of type `any`.","line":6,"column":5,"nodeType":"ReturnStatement","messageId":"unsafeReturn","endLine":6,"endColumn":25},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .user on an `any` value.","line":6,"column":20,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":6,"endColumn":24}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createParamDecorator, ExecutionContext } from '@nestjs/common';\r\n\r\nexport const CurrentUser = createParamDecorator(\r\n  (data: unknown, ctx: ExecutionContext) => {\r\n    const request = ctx.switchToHttp().getRequest();\r\n    return request.user;\r\n  },\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/decorators/roles.decorator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/enums/role.enum.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/guards/jwt-auth.guard.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/guards/roles.guard.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":20,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":20,"endColumn":57},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .roles on an `any` value.","line":23,"column":24,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":23,"endColumn":29},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of an `any` typed value.","line":27,"column":41,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":27,"endColumn":61},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .roles on an `any` value.","line":27,"column":46,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":27,"endColumn":51}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common';\r\nimport { Reflector } from '@nestjs/core';\r\nimport { ROLES_KEY } from '../decorators/roles.decorator';\r\nimport { Role } from '../enums/role.enum';\r\n\r\n@Injectable()\r\nexport class RolesGuard implements CanActivate {\r\n  constructor(private reflector: Reflector) {}\r\n\r\n  canActivate(context: ExecutionContext): boolean {\r\n    const requiredRoles = this.reflector.getAllAndOverride<Role[]>(ROLES_KEY, [\r\n      context.getHandler(),\r\n      context.getClass(),\r\n    ]);\r\n\r\n    if (!requiredRoles) {\r\n      return true;\r\n    }\r\n\r\n    const { user } = context.switchToHttp().getRequest();\r\n\r\n    // Nếu API yêu cầu Roles nhưng user ko có role nào -> từ chối\r\n    if (!user || !user.roles) {\r\n      return false;\r\n    }\r\n\r\n    return requiredRoles.some((role) => user.roles?.includes(role));\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/schemas/user.schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/auth/strategies/jwt.strategy.ts","messages":[{"ruleId":"@typescript-eslint/require-await","severity":2,"message":"Async method 'validate' has no 'await' expression.","line":16,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":16,"endColumn":17,"suggestions":[{"messageId":"removeAsync","fix":{"range":[550,556],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .sub on an `any` value.","line":19,"column":18,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":19,"endColumn":21},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":24,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":24,"endColumn":22},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .sub on an `any` value.","line":24,"column":19,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":24,"endColumn":22},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":25,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":25,"endColumn":33},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .roles on an `any` value.","line":25,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":25,"endColumn":27}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Injectable, UnauthorizedException } from '@nestjs/common';\r\nimport { PassportStrategy } from '@nestjs/passport';\r\nimport { ExtractJwt, Strategy } from 'passport-jwt';\r\nimport { ConfigService } from '@nestjs/config';\r\n\r\n@Injectable()\r\nexport class JwtStrategy extends PassportStrategy(Strategy) {\r\n  constructor(private configService: ConfigService) {\r\n    super({\r\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\r\n      ignoreExpiration: false,\r\n      secretOrKey: configService.get<string>('JWT_SECRET'),\r\n    });\r\n  }\r\n\r\n  async validate(payload: any) {\r\n    // payload đã được check signature và expiration tự động bởi Passport.\r\n    // Dữ liệu bóc ra từ payload sẽ được gán vào `req.user`\r\n    if (!payload.sub) {\r\n      throw new UnauthorizedException();\r\n    }\r\n\r\n    return {\r\n      id: payload.sub,\r\n      roles: payload.roles || [],\r\n    };\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/driver-location.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/driver.controller.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .status on an `any` value.","line":44,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":44,"endColumn":29},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .isAvailable on an `any` value.","line":45,"column":42,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":45,"endColumn":53},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":1,"message":"Unsafe argument of type `any` assigned to a parameter of type `string`.","line":52,"column":38,"nodeType":"MemberExpression","messageId":"unsafeArgument","endLine":52,"endColumn":49},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .user on an `any` value.","line":52,"column":42,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":52,"endColumn":46}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  Controller,\n  Get,\n  Post,\n  Body,\n  Put,\n  Param,\n  Delete,\n  UseGuards,\n  Query,\n  Req,\n} from '@nestjs/common';\nimport { DriverService } from './driver.service';\nimport { DriverLocationService } from './driver-location.service';\nimport { CreateDriverDto } from './dto/create-driver.dto';\nimport { UpdateDriverDto } from './dto/update-driver.dto';\nimport { UpdateLocationDto } from './dto/update-location.dto';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { RolesGuard } from '../auth/guards/roles.guard';\nimport { Roles } from '../auth/decorators/roles.decorator';\nimport { Role } from '../auth/enums/role.enum';\n\n@Controller('drivers')\n@UseGuards(JwtAuthGuard, RolesGuard)\nexport class DriverController {\n  constructor(\n    private readonly driverService: DriverService,\n    private readonly driverLocationService: DriverLocationService,\n  ) {}\n\n  @Post()\n  @Roles(Role.ADMIN)\n  create(@Body() createDriverDto: CreateDriverDto) {\n    return this.driverService.create(createDriverDto);\n  }\n\n  @Get()\n  @Roles(Role.ADMIN, Role.DISPATCHER)\n  findAll(\n    @Query('status') status?: string,\n    @Query('isAvailable') isAvailable?: string,\n  ) {\n    const query: any = {};\n    if (status) query.status = status;\n    if (isAvailable !== undefined) query.isAvailable = isAvailable === 'true';\n    return this.driverService.findAll(query);\n  }\n\n  @Get('me')\n  @Roles(Role.DRIVER)\n  findMe(@Req() req: any) {\n    return this.driverService.findMe(req.user.id);\n  }\n\n  @Get('available')\n  @Roles(Role.ADMIN, Role.DISPATCHER)\n  findAvailable() {\n    return this.driverService.findAvailable();\n  }\n\n  @Get(':id')\n  @Roles(Role.ADMIN, Role.DISPATCHER)\n  findOne(@Param('id') id: string) {\n    return this.driverService.findOne(id);\n  }\n\n  @Put(':id')\n  @Roles(Role.ADMIN)\n  update(@Param('id') id: string, @Body() updateDriverDto: UpdateDriverDto) {\n    return this.driverService.update(id, updateDriverDto);\n  }\n\n  @Delete(':id')\n  @Roles(Role.ADMIN)\n  remove(@Param('id') id: string) {\n    return this.driverService.remove(id);\n  }\n\n  @Post(':id/location')\n  @Roles(Role.DRIVER)\n  updateLocation(\n    @Param('id') id: string,\n    @Body() updateLocationDto: UpdateLocationDto,\n  ) {\n    return this.driverLocationService.updateLocation(\n      id,\n      updateLocationDto.lat,\n      updateLocationDto.lng,\n    );\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/driver.module.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/driver.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":20,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":20,"endColumn":40},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":31,"column":18,"nodeType":"Property","messageId":"anyAssignment","endLine":31,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":1,"message":"Unsafe argument of type `any` assigned to a parameter of type `_QueryFilter<{ set: { <T extends string | number | symbol>(path: T, val: any, type: any, options?: DocumentSetOptions): DriverDocument; (path: string | Record<string, any>, val: any, type: any, options?: DocumentSetOptions): DriverDocument; (path: string | Record<...>, val: any, options?: DocumentSetOptions): Driver...`.","line":41,"column":34,"nodeType":"Identifier","messageId":"unsafeArgument","endLine":41,"endColumn":39}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  Injectable,\n  NotFoundException,\n  ConflictException,\n} from '@nestjs/common';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { Model } from 'mongoose';\nimport { Driver, DriverDocument } from './schemas/driver.schema';\nimport { CreateDriverDto } from './dto/create-driver.dto';\nimport { UpdateDriverDto } from './dto/update-driver.dto';\n\n@Injectable()\nexport class DriverService {\n  constructor(\n    @InjectModel(Driver.name) private driverModel: Model<DriverDocument>,\n  ) {}\n\n  async create(createDriverDto: CreateDriverDto): Promise<Driver> {\n    const existingDriver = await this.driverModel.findOne({\n      user: createDriverDto.user as any,\n    });\n    if (existingDriver) {\n      throw new ConflictException('Người dùng này đã trở thành Tài xế');\n    }\n    const createdDriver = new this.driverModel(createDriverDto);\n    return createdDriver.save();\n  }\n\n  async findMe(userId: string): Promise<Driver> {\n    const driver = await this.driverModel\n      .findOne({ user: userId as any })\n      .populate('user')\n      .exec();\n    if (!driver) {\n      throw new NotFoundException(`Không tìm thấy hồ sơ Tài xế của bạn`);\n    }\n    return driver;\n  }\n\n  async findAll(query: any = {}): Promise<Driver[]> {\n    return this.driverModel.find(query).populate('user').exec();\n  }\n\n  async findAvailable(): Promise<Driver[]> {\n    return this.driverModel.find({ isAvailable: true }).populate('user').exec();\n  }\n\n  async findOne(id: string): Promise<Driver> {\n    const driver = await this.driverModel.findById(id).populate('user').exec();\n    if (!driver) {\n      throw new NotFoundException(`Không tìm thấy Tài xế có ID: ${id}`);\n    }\n    return driver;\n  }\n\n  async update(id: string, updateDriverDto: UpdateDriverDto): Promise<Driver> {\n    const driver = await this.driverModel\n      .findByIdAndUpdate(id, updateDriverDto, { new: true })\n      .populate('user')\n      .exec();\n\n    if (!driver) {\n      throw new NotFoundException(`Không tìm thấy Tài xế có ID: ${id}`);\n    }\n    return driver;\n  }\n\n  async remove(id: string): Promise<Driver> {\n    // Vô hiệu hóa Tài xế (Soft delete)\n    const driver = await this.driverModel\n      .findByIdAndUpdate(\n        id,\n        { isAvailable: false, status: 'OFFLINE' },\n        { new: true },\n      )\n      .exec();\n\n    if (!driver) {\n      throw new NotFoundException(`Không tìm thấy Tài xế có ID: ${id}`);\n    }\n    return driver;\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/dto/create-driver.dto.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/dto/update-driver.dto.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IsString' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IsString"},"fix":{"range":[66,79],"text":""},"desc":"Remove unused variable \"IsString\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  IsEnum,\r\n  IsBoolean,\r\n  IsOptional,\r\n  ValidateNested,\r\n  IsString,\r\n  IsMongoId,\r\n} from 'class-validator';\r\nimport { Type } from 'class-transformer';\r\nimport { VehicleDto } from './create-driver.dto';\r\nimport { DriverStatus } from '../schemas/driver.schema';\r\n\r\nexport class UpdateDriverDto {\r\n  @IsMongoId()\r\n  @IsOptional()\r\n  user?: string;\r\n\r\n  @ValidateNested()\r\n  @Type(() => VehicleDto)\r\n  @IsOptional()\r\n  vehicle?: VehicleDto;\r\n\r\n  @IsEnum(DriverStatus)\r\n  @IsOptional()\r\n  status?: DriverStatus;\r\n\r\n  @IsBoolean()\r\n  @IsOptional()\r\n  isAvailable?: boolean;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/dto/update-location.dto.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/driver/schemas/driver.schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/src/main.ts","messages":[{"ruleId":"@typescript-eslint/no-floating-promises","severity":1,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":21,"column":1,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":21,"endColumn":13,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[553,553],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[553,553],"text":"await "},"desc":"Add await operator."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NestFactory } from '@nestjs/core';\nimport { ApiGatewayModule } from './api-gateway.module';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(ApiGatewayModule);\n\n  app.enableCors({\n    // Cho phép cổng 8080 (HTML test cũ) và 3001 (Next.js FE mới)\n    origin: [\n      'http://localhost:8080',\n      'http://localhost:3001',\n      'http://127.0.0.1:8080',\n      'http://127.0.0.1:3001',\n    ],\n    methods: 'GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS',\n    credentials: true,\n  });\n\n  await app.listen(process.env.port ?? 3000);\n}\nbootstrap();\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/apps/api-gateway/test/app.e2e-spec.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":1,"message":"Unsafe argument of type `any` assigned to a parameter of type `App`.","line":19,"column":20,"nodeType":"CallExpression","messageId":"unsafeArgument","endLine":19,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Test, TestingModule } from '@nestjs/testing';\nimport { INestApplication } from '@nestjs/common';\nimport request from 'supertest';\nimport { ApiGatewayModule } from './../src/api-gateway.module';\n\ndescribe('ApiGatewayController (e2e)', () => {\n  let app: INestApplication;\n\n  beforeEach(async () => {\n    const moduleFixture: TestingModule = await Test.createTestingModule({\n      imports: [ApiGatewayModule],\n    }).compile();\n\n    app = moduleFixture.createNestApplication();\n    await app.init();\n  });\n\n  it('/ (GET)', () => {\n    return request(app.getHttpServer())\n      .get('/')\n      .expect(200)\n      .expect('Hello World!');\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/common/src/common.module.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/common/src/config/config.schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/common/src/filters/all-exceptions.filter.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":39,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":42,"endColumn":20},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":41,"column":30,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":41,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":43,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":46,"endColumn":17},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":45,"column":30,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":45,"endColumn":35}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  ExceptionFilter,\r\n  Catch,\r\n  ArgumentsHost,\r\n  HttpException,\r\n  HttpStatus,\r\n  Logger,\r\n} from '@nestjs/common';\r\nimport { Request, Response } from 'express';\r\n\r\n@Catch()\r\nexport class AllExceptionsFilter implements ExceptionFilter {\r\n  private readonly logger = new Logger(AllExceptionsFilter.name);\r\n\r\n  catch(exception: unknown, host: ArgumentsHost) {\r\n    const ctx = host.switchToHttp();\r\n    const response = ctx.getResponse<Response>();\r\n    const request = ctx.getRequest<Request>();\r\n\r\n    const status =\r\n      exception instanceof HttpException\r\n        ? exception.getStatus()\r\n        : HttpStatus.INTERNAL_SERVER_ERROR;\r\n\r\n    const message =\r\n      exception instanceof HttpException\r\n        ? exception.getResponse()\r\n        : 'Internal server error';\r\n\r\n    this.logger.error(\r\n      `[${request.method}] ${request.url} - Status: ${status}`,\r\n      exception instanceof Error ? exception.stack : JSON.stringify(exception),\r\n    );\r\n\r\n    response.status(status).json({\r\n      statusCode: status,\r\n      timestamp: new Date().toISOString(),\r\n      path: request.url,\r\n      message:\r\n        typeof message === 'object' && 'message' in message\r\n          ? (message as any).message\r\n          : message,\r\n      error:\r\n        typeof message === 'object' && 'error' in message\r\n          ? (message as any).error\r\n          : null,\r\n    });\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/common/src/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/common/src/interceptors/transform.interceptor.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":25,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":25,"endColumn":71},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .statusCode on an `any` value.","line":25,"column":61,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":25,"endColumn":71},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":29,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":29,"endColumn":19},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":31,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":31,"endColumn":13}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  Injectable,\r\n  NestInterceptor,\r\n  ExecutionContext,\r\n  CallHandler,\r\n} from '@nestjs/common';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nexport interface Response<T> {\r\n  data: T;\r\n  statusCode: number;\r\n  message: string;\r\n}\r\n\r\n@Injectable()\r\nexport class TransformInterceptor<T> implements NestInterceptor<\r\n  T,\r\n  Response<T>\r\n> {\r\n  intercept(\r\n    context: ExecutionContext,\r\n    next: CallHandler,\r\n  ): Observable<Response<T>> {\r\n    const statusCode = context.switchToHttp().getResponse().statusCode;\r\n\r\n    return next.handle().pipe(\r\n      map((data) => ({\r\n        statusCode,\r\n        message: 'Success',\r\n        data,\r\n      })),\r\n    );\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/database/src/database.module.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/database/src/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/firebase/src/firebase.module.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/hoangnq/ai-driven/product-app/logitrack/logitrack-backend/libs/firebase/src/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
